<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SharePoint Layout Renderer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .zone {
      /* display: flex; */
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    .section {
      flex: 1;
      padding: 10px;
      box-sizing: border-box;
    }
    .webpart {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
      background: #f9f9f9;
    }
    .webpart img {
      max-width: 100%;
      height: auto;
    }
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
    }
    .video-container video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  </style>

<link rel="stylesheet" href="sharepoint-styles.css">

</head>
<body>
  <div id="layout"></div>

  <script>
    const layoutData = [
    {
        "position": {
            "layoutIndex": 1,
            "zoneIndex": 1,
            "zoneId": "f924f566-f485-498e-853d-e2ffe6db1fd7",
            "sectionIndex": 1,
            "sectionFactor": 12,
            "controlIndex": 1
        },
        "id": "8c5036e7-a0ff-40c9-83c1-1a8c45f06701",
        "controlType": 3,
        "isFromSectionTemplate": false,
        "addedFromPersistedData": true,
        "webPartId": "ac0e47ca-30af-452c-bdbb-510b715d0e46",
        "reservedWidth": 1188,
        "reservedHeight": 688,
        "webPartData": {
            "id": "ac0e47ca-30af-452c-bdbb-510b715d0e46",
            "instanceId": "8c5036e7-a0ff-40c9-83c1-1a8c45f06701",
            "title": "Stream",
            "description": "Muestra un solo vídeo o varios vídeos de una carpeta en OneDrive o SharePoint.",
            "audiences": [],
            "serverProcessedContent": {
                "htmlStrings": {},
                "searchablePlainTexts": {
                    "title": "Flynn_Keele_IMG_4441"
                },
                "imageSources": {},
                "links": {
                    "baseUrl": "/sites/O365-Luddy33"
                },
                "componentDependencies": {
                    "layoutComponentId": "7a834a65-c7a6-4641-9cb7-e6d2724a5df0"
                }
            },
            "dataVersion": "1.3",
            "properties": {
                "label": "This is an example property",
                "isTitleEnabled": false,
                "query": {
                    "contentLocation": 1,
                    "contentTypes": [
                        3
                    ],
                    "documentTypes": [
                        11
                    ],
                    "sortType": 6
                },
                "templateId": 2,
                "maxItemsPerPage": 6,
                "maxRowsPerPageGrid": 2,
                "maxRowsPerPageTheater": 1,
                "hideWebPartWhenEmpty": true,
                "sourceType": "VIDEO",
                "listSortField": "Created",
                "playlistSortField": "Default",
                "isPlaceholderState": false,
                "dataProviderId": "StreamVideo",
                "layoutId": "Theater",
                "displayMaps": {
                    "1": {
                        "headingText": {
                            "sources": [
                                "SiteTitle"
                            ]
                        },
                        "spWebUrl": {
                            "sources": [
                                "SPWebUrl"
                            ]
                        },
                        "title": {
                            "sources": [
                                "UserName",
                                "Title"
                            ]
                        },
                        "personImageUrl": {
                            "sources": [
                                "ProfileImageSrc"
                            ]
                        },
                        "name": {
                            "sources": [
                                "Name"
                            ]
                        },
                        "initials": {
                            "sources": [
                                "Initials"
                            ]
                        },
                        "itemUrl": {
                            "sources": [
                                "WebPath"
                            ]
                        },
                        "activity": {
                            "sources": [
                                "ModifiedDate"
                            ]
                        },
                        "previewUrl": {
                            "sources": [
                                "PreviewUrl",
                                "PictureThumbnailURL"
                            ]
                        },
                        "iconUrl": {
                            "sources": [
                                "IconUrl"
                            ]
                        },
                        "accentColor": {
                            "sources": [
                                "AccentColor"
                            ]
                        },
                        "cardType": {
                            "sources": [
                                "CardType"
                            ]
                        },
                        "tipActionLabel": {
                            "sources": [
                                "TipActionLabel"
                            ]
                        },
                        "tipActionButtonIcon": {
                            "sources": [
                                "TipActionButtonIcon"
                            ]
                        },
                        "className": {
                            "sources": [
                                "ClassName"
                            ]
                        },
                        "uniqueId": {
                            "sources": [
                                "UniqueID"
                            ]
                        },
                        "fileExt": {
                            "sources": [
                                "FileType"
                            ]
                        },
                        "telemetryProperties": {
                            "sources": [
                                "TelemetryProperties"
                            ]
                        },
                        "imageOverlapText": {
                            "sources": [
                                "ImageOverlapText"
                            ]
                        },
                        "imageOverlapTextAriaLabel": {
                            "sources": [
                                "ImageOverlapTextAriaLabel"
                            ]
                        },
                        "listItemId": {
                            "sources": [
                                "listItemId"
                            ]
                        }
                    },
                    "2": {
                        "headingText": {
                            "sources": [
                                "SiteTitle"
                            ]
                        },
                        "spWebUrl": {
                            "sources": [
                                "SPWebUrl"
                            ]
                        },
                        "title": {
                            "sources": [
                                "UserName",
                                "Title"
                            ]
                        },
                        "personImageUrl": {
                            "sources": [
                                "ProfileImageSrc"
                            ]
                        },
                        "name": {
                            "sources": [
                                "Name"
                            ]
                        },
                        "initials": {
                            "sources": [
                                "Initials"
                            ]
                        },
                        "itemUrl": {
                            "sources": [
                                "WebPath"
                            ]
                        },
                        "activity": {
                            "sources": [
                                "ModifiedDate"
                            ]
                        },
                        "previewUrl": {
                            "sources": [
                                "PreviewUrl",
                                "PictureThumbnailURL"
                            ]
                        },
                        "iconUrl": {
                            "sources": [
                                "IconUrl"
                            ]
                        },
                        "accentColor": {
                            "sources": [
                                "AccentColor"
                            ]
                        },
                        "cardType": {
                            "sources": [
                                "CardType"
                            ]
                        },
                        "tipActionLabel": {
                            "sources": [
                                "TipActionLabel"
                            ]
                        },
                        "tipActionButtonIcon": {
                            "sources": [
                                "TipActionButtonIcon"
                            ]
                        },
                        "className": {
                            "sources": [
                                "ClassName"
                            ]
                        },
                        "uniqueId": {
                            "sources": [
                                "UniqueID"
                            ]
                        },
                        "fileExt": {
                            "sources": [
                                "FileType"
                            ]
                        },
                        "telemetryProperties": {
                            "sources": [
                                "TelemetryProperties"
                            ]
                        },
                        "imageOverlapText": {
                            "sources": [
                                "ImageOverlapText"
                            ]
                        },
                        "imageOverlapTextAriaLabel": {
                            "sources": [
                                "ImageOverlapTextAriaLabel"
                            ]
                        },
                        "listItemId": {
                            "sources": [
                                "listItemId"
                            ]
                        }
                    }
                },
                "webId": "55e38060-5695-40ae-9e56-d5052da7ffd2",
                "siteId": "552ed27f-2553-4ff7-b1dd-49cfb87caae4",
                "rootFolder": "/personal/reeneedh_iu_edu/Documents/Bus%20Lag/V%C3%ADdeos!/Flynn/Flynn_Keele_IMG_4441.mov",
                "link": "https://indiana-my.sharepoint.com/personal/reeneedh_iu_edu/Documents/Bus%20Lag/V%C3%ADdeos!/Flynn/Flynn_Keele_IMG_4441.mov",
                "listId": "{16A1869C-CDC1-4AF6-B23B-64D5BBF8E56C}",
                "uniqueId": "6b13dfeb-637a-46a0-93bd-aa90086b1f91",
                "file": "https://indiana-my.sharepoint.com/personal/reeneedh_iu_edu/Documents/Bus%20Lag/V%C3%ADdeos!/Flynn/Flynn_Keele_IMG_4441.mov",
                "spWebUrl": "https://indiana-my.sharepoint.com/personal/reeneedh_iu_edu",
                "previewUrl": "https://indiana-my.sharepoint.com/_api/v2.1/sites/indiana-my.sharepoint.com,a84edd6e-7bbe-423e-acd7-c7c51929d9b8,086be8c1-e9a2-4995-a075-ec29cca29ef0/lists/16a1869c-cdc1-4af6-b23b-64d5bbf8e56c/items/6b13dfeb-637a-46a0-93bd-aa90086b1f91/driveItem/thumbnails/0/c400x99999/content?prefer=noRedirect,extendCacheMaxAge&clientType=modernWebPart",
                "videoDuration": null,
                "listTitle": "Flynn_Keele_IMG_4441",
                "serverRelativePath": "https://indiana-my.sharepoint.com/personal/reeneedh_iu_edu/Documents/Bus%20Lag/V%C3%ADdeos!/Flynn/Flynn_Keele_IMG_4441.mov",
                "wopiurl": "https://indiana-my.sharepoint.com/personal/reeneedh_iu_edu/Documents/Bus%20Lag/V%C3%ADdeos!/Flynn/Flynn_Keele_IMG_4441.mov",
                "serverRelativeUrl": "https://indiana-my.sharepoint.com/personal/reeneedh_iu_edu/Documents/Bus%20Lag/V%C3%ADdeos!/Flynn/Flynn_Keele_IMG_4441.mov",
                "crossSiteId": "a84edd6e-7bbe-423e-acd7-c7c51929d9b8",
                "crossWebId": "086be8c1-e9a2-4995-a075-ec29cca29ef0",
                "webAbsoluteUrl": "https://indiana-my.sharepoint.com/personal/reeneedh_iu_edu"
            },
            "containsDynamicDataSource": false
        }
    },
    {
        "position": {
            "layoutIndex": 1,
            "zoneIndex": 1,
            "zoneId": "f924f566-f485-498e-853d-e2ffe6db1fd7",
            "sectionIndex": 1,
            "sectionFactor": 12,
            "controlIndex": 2
        },
        "id": "e58a2b68-c4d9-4331-a03b-09cb35ec7edc",
        "controlType": 3,
        "isFromSectionTemplate": false,
        "addedFromPersistedData": true,
        "webPartId": "544dd15b-cf3c-441b-96da-004d5a8cea1d",
        "reservedWidth": 1188,
        "reservedHeight": 695,
        "webPartData": {
            "id": "544dd15b-cf3c-441b-96da-004d5a8cea1d",
            "instanceId": "e58a2b68-c4d9-4331-a03b-09cb35ec7edc",
            "title": "YouTube",
            "description": "Muestre un vídeo de YouTube en la página.",
            "audiences": [],
            "serverProcessedContent": {
                "htmlStrings": {},
                "searchablePlainTexts": {
                    "title": "Dog of Wisdom - YouTube"
                },
                "imageSources": {},
                "links": {}
            },
            "dataVersion": "1.2",
            "properties": {
                "embedCode": "<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/D-UmfqFjpl0?si=TFl44TC54kIqeNkY\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen=\"\"></iframe>",
                "shouldScaleWidth": true,
                "runtimeState": {
                    "isPrivate": false,
                    "showControls": true
                },
                "thumbnailUrl": "https://i.ytimg.com/vi/D-UmfqFjpl0/hqdefault.jpg",
                "cachedEmbedCode": "<iframe width=560 height=315 src=https://www.youtube.com/embed/D-UmfqFjpl0?si=TFl44TC54kIqeNkY frameborder=0 allow=accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share referrerpolicy=strict-origin-when-cross-origin allowfullscreen> </iframe>",
                "cachedEmbedCodeThumbnail": "https://i.ytimg.com/vi/D-UmfqFjpl0/hqdefault.jpg"
            },
            "containsDynamicDataSource": false
        }
    },
    {
        "position": {
            "layoutIndex": 1,
            "zoneIndex": 1,
            "zoneId": "f924f566-f485-498e-853d-e2ffe6db1fd7",
            "sectionIndex": 1,
            "sectionFactor": 12,
            "controlIndex": 3
        },
        "id": "08fecf89-3fec-4645-ae12-1baa6bbbff40",
        "controlType": 4,
        "isFromSectionTemplate": false,
        "addedFromPersistedData": true,
        "innerHTML": "<h2 class=\"headingSpacingAbove headingSpacingBelow\">Welcome to Training!</h2><p class=\"noSpacingAbove spacingBelow\" data-text-type=\"withSpacing\">Today we're going to <i><strong><u>LEARN A BUNCH OF COOL STUFF</u></strong></i>. And it case you <span class=\"fontColorRed\">didn't already know</span>, you're <span class=\"highlightColorYellow\">going to SLAY</span> at this training.</p><p class=\"noSpacingAbove spacingBelow\" data-text-type=\"withSpacing\" aria-hidden=\"true\">&nbsp;</p><p>Oh, and here's a welcome mat:</p><div class=\"imagePlugin\" style=\"background-color:transparent;position:relative;\" data-alignment=\"Center\" data-imageurl=\"https://indiana.sharepoint.com/sites/O365-Luddy33/Shared%20Documents/General/Captura%20de%20pantalla%202023-12-18%20a%20las%2014.11.37.png\" data-uploading=\"0\" data-width=\"791.45703125\" data-height=\"458.77678760593216\" data-imagenaturalheight=\"684\" data-imagenaturalwidth=\"1180\" data-webid=\"55e38060-5695-40ae-9e56-d5052da7ffd2\" data-siteid=\"552ed27f-2553-4ff7-b1dd-49cfb87caae4\" data-listid=\"33c19805-1ece-430f-8c38-a2f054632194\" data-uniqueid=\"{7cf04a0d-b7b1-4a14-90e8-844b5b138948}\" data-widthpercentage=\"66.84603304476352\"></div><p>&nbsp;</p>"
    },
    {
        "position": {
            "layoutIndex": 1,
            "zoneIndex": 1,
            "zoneId": "f924f566-f485-498e-853d-e2ffe6db1fd7",
            "sectionIndex": 1,
            "sectionFactor": 12,
            "controlIndex": 4
        },
        "id": "3c3c2702-99bd-4806-8cef-75b527528b8c",
        "controlType": 3,
        "isFromSectionTemplate": false,
        "addedFromPersistedData": true,
        "webPartId": "d1d91016-032f-456d-98a4-721247c305e8",
        "reservedWidth": 1188,
        "reservedHeight": 725,
        "webPartData": {
            "id": "d1d91016-032f-456d-98a4-721247c305e8",
            "instanceId": "3c3c2702-99bd-4806-8cef-75b527528b8c",
            "title": "Imagen",
            "description": "Agregue una imagen, una imagen o una foto a la página, incluyendo texto superpuesto y la capacidad de recortar y cambiar el tamaño de las imágenes.",
            "audiences": [],
            "serverProcessedContent": {
                "htmlStrings": {},
                "searchablePlainTexts": {},
                "imageSources": {
                    "imageSource": "/sites/O365-Luddy33/SiteAssets/SitePages/VideoTest/copy-(1)-Reece_Needham_IMG_3881-977061.jpeg"
                },
                "links": {},
                "customMetadata": {
                    "imageSource": {
                        "siteid": "552ed27f-2553-4ff7-b1dd-49cfb87caae4",
                        "webid": "55e38060-5695-40ae-9e56-d5052da7ffd2",
                        "listid": "f7b45157-6b50-4f7f-a8af-53863d73cbbb",
                        "uniqueid": "6f12daa5-5f00-405e-83c9-24f4bb1ef1eb",
                        "width": "4284",
                        "height": "5712"
                    }
                }
            },
            "dataVersion": "1.13",
            "properties": {
                "imageSourceType": 2,
                "captionText": "",
                "altText": "",
                "linkUrl": "",
                "overlayText": "",
                "fileName": "Reece_Needham_IMG_3881_1747945458469.jpeg",
                "siteId": "552ed27f-2553-4ff7-b1dd-49cfb87caae4",
                "webId": "55e38060-5695-40ae-9e56-d5052da7ffd2",
                "listId": "f7b45157-6b50-4f7f-a8af-53863d73cbbb",
                "uniqueId": "6f12daa5-5f00-405e-83c9-24f4bb1ef1eb",
                "imgWidth": 4284,
                "imgHeight": 5712,
                "overlayTextStyles": {
                    "textColor": "light",
                    "isBold": false,
                    "isItalic": false,
                    "textBoxColor": "dark",
                    "textBoxOpacity": 0.54,
                    "overlayColor": "light",
                    "overlayTransparency": 0
                },
                "minimumLayoutWidth": 1,
                "customContentDropSupport": "externallink",
                "isOverlayTextVisible": true,
                "resizeCoefficient": 0.45791245791245794,
                "resizeDesiredWidth": 544,
                "alignment": "Center",
                "fixAspectRatio": false
            },
            "containsDynamicDataSource": false
        }
    },
    {
        "position": {
            "layoutIndex": 1,
            "zoneIndex": 2,
            "zoneId": "75438fbd-23a1-4dba-ab0f-5897e76d6204",
            "sectionIndex": 1,
            "sectionFactor": 6,
            "controlIndex": 1
        },
        "id": "51a5aa51-1978-4cdb-8465-5bf616640721",
        "controlType": 4,
        "isFromSectionTemplate": false,
        "addedFromPersistedData": true,
        "innerHTML": "<p>Here's a column on the left</p>"
    },
    {
        "position": {
            "layoutIndex": 1,
            "zoneIndex": 2,
            "zoneId": "75438fbd-23a1-4dba-ab0f-5897e76d6204",
            "sectionIndex": 2,
            "sectionFactor": 6,
            "controlIndex": 1
        },
        "id": "7e47844e-868b-4d08-982a-9701c35d1e08",
        "controlType": 4,
        "isFromSectionTemplate": false,
        "addedFromPersistedData": true,
        "innerHTML": "<p>And here's a column on the right I guess.</p>"
    },
    {
        "controlType": 0,
        "pageSettingsSlice": {
            "isDefaultDescription": true,
            "isDefaultThumbnail": false,
            "isSpellCheckEnabled": true,
            "globalRichTextStylingVersion": 0,
            "rtePageSettings": {
                "contentVersion": 4
            },
            "isEmailReady": false,
            "webPartsPageSettings": {
                "isTitleHeadingLevelsEnabled": false
            }
        }
    }
];

    const layoutContainer = document.getElementById('layout');
    const zones = {};

    layoutData.forEach(control => {
      const { zoneId, sectionIndex, sectionFactor } = control.position;
      const zoneKey = `${zoneId}-${sectionIndex}`;

      if (!zones[zoneKey]) {
        const zoneDiv = document.createElement('div');
        zoneDiv.className = 'zone';
        zones[zoneKey] = zoneDiv;
        layoutContainer.appendChild(zoneDiv);
      }

      const sectionDiv = document.createElement('div');
      sectionDiv.className = 'section';
      sectionDiv.style.flex = sectionFactor / 12;

      const webpartDiv = document.createElement('div');
      webpartDiv.className = 'webpart';

      if (control.controlType === 4) {
        webpartDiv.innerHTML = control.innerHTML;
      } else if (control.controlType === 3) {
        const wp = control.webPartData;
        if (wp.properties && wp.properties.file) {
          const video = document.createElement('video');
          video.src = wp.properties.file;
          video.controls = true;
          video.style.width = '100%';
          webpartDiv.appendChild(video);
        } else if (wp.serverProcessedContent?.imageSources?.imageSource) {
          const img = document.createElement('img');
          img.src = wp.serverProcessedContent.imageSources.imageSource;
          webpartDiv.appendChild(img);
        } else {
          webpartDiv.innerHTML = `<p>Unsupported Web Part</p>`;
        }
      }

      sectionDiv.appendChild(webpartDiv);
      zones[zoneKey].appendChild(sectionDiv);
    });
  </script>
</body>
</html>
